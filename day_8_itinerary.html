<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 8 (2/11)：飯店 → 關西機場 (KIX)</title>
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 設置 Inter 字體為主要字體，增加可讀性 */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        /* 定義卡片樣式 */
        .route-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 1.5rem;
        }

        /* 天氣載入動畫 */
        .weather-loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: .5;
            }
        }
    </style>
</head>

<body class="p-0 sm:p-6">
    <!-- Daily Navigation Bar (Fixed at top for mobile experience) -->
    <div class="sticky top-0 z-10 bg-white border-b border-gray-200 shadow-md mb-6 py-2 overflow-x-auto">
        <div class="flex space-x-2 px-4 whitespace-nowrap">
            <!-- 總覽 (New Link) -->
            <a href="itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">總覽</a>
            <!-- NEW: 實用工具連結 -->
            <a href="tools.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">實用工具</a>
            <!-- Day 1 -->
            <a href="day_1_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                1</a>
            <!-- Day 2 -->
            <a href="day_2_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                2</a>
            <!-- Day 3 -->
            <a href="day_3_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                3</a>
            <!-- Day 4 -->
            <a href="day_4_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                4</a>
            <!-- Day 5 -->
            <a href="day_5_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                5</a>
            <!-- Day 6 -->
            <a href="day_6_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                6</a>
            <!-- Day 7 -->
            <a href="day_7_itinerary.html"
                class="px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 transition duration-150">Day
                7</a>
            <!-- Day 8 (Active) -->
            <a href="day_8_itinerary.html"
                class="px-3 py-1 text-sm font-semibold rounded-full bg-blue-600 text-white shadow-lg transition duration-150">Day
                8</a>
        </div>
    </div>

    <!-- 主容器：限制最大寬度，適合手機螢幕 -->
    <div class="max-w-xl mx-auto px-4 sm:px-0">
        <!-- 頁面標題 -->
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800 flex items-center justify-center">
                <span class="mr-2">📅</span> Day 8 (2/11)：飯店 → 關西機場 (KIX)
            </h1>
            <h2 class="text-xl text-gray-600 mt-1">
                主要任務：準時前往機場，搭乘 BR177 班機
            </h2>
        </header>

        <!-- 封面圖片 -->
        <div class="mb-6">
            <img src="image/day8.jpg" alt="Day 8 返程封面" class="w-full rounded-2xl shadow-lg"
                onerror="this.style.display='none'">
        </div>

        <!-- 區塊一：航班與時間總覽 -->
        <div class="route-card bg-blue-100 border-t-4 border-blue-500">
            <h3 class="text-2xl font-semibold text-indigo-800 mb-4 flex items-center">
                <span class="mr-2">✈️</span> 航班與時間總覽
            </h3>

            <p class="text-gray-700 mb-4">
                回程航班：<strong>BR177</strong> (10:55 KIX 發車)
            </p>

            <!-- 關鍵數據列表 -->
            <div class="space-y-2">
                <div class="flex items-center text-gray-700">
                    <span class="font-bold w-32 text-indigo-600">⏱️ 出發時間：</span>
                    <span><strong>07:00</strong> 前從飯店出發 (需預留充足的 check-in 時間)</span>
                </div>
                <div class="flex items-center text-gray-700">
                    <span class="font-bold w-32 text-indigo-600">💰 交通費用：</span>
                <strong>使用JR PASS 需注意劃位&nbsp;</strong> </div>
                <div class="flex items-center text-gray-700">
                    <span class="font-bold w-32 text-indigo-600">🎯 建議交通：</span>
                    <span>JR <strong>關空特快 Haruka</strong> 列車 (最快)</span>
                </div>
                <div class="flex items-center text-gray-700">
                    <span class="font-bold w-32 text-indigo-600">💡 提示：</span>
                    <span>請於<strong>出發前</strong>確認<strong>Haruka</strong>的時刻表，確保有足夠的彈性時間。</span>
                </div>
            </div>
        </div>

        <!-- NEW: 天氣資訊區塊 (Open-Meteo JMA Source) -->
        <div class="route-card bg-sky-50 border-t-4 border-sky-400">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-2xl font-semibold text-sky-800 flex items-center">
                    <span class="mr-2">🌥️</span> 目的地天氣
                </h3>
                <span class="text-xs text-gray-500 bg-white px-2 py-1 rounded border">Data: JMA (via Open-Meteo)</span>
            </div>

            <div id="weather-container" class="grid grid-cols-2 gap-4">
                <!-- 京都車站 -->
                <div id="weather-kyoto"
                    class="bg-white p-3 rounded-lg shadow-sm text-center weather-loading min-h-[120px] flex flex-col justify-center">
                    <p class="text-sm font-bold text-gray-700 mb-1">京都車站</p>
                    <p class="text-xs text-gray-400">載入中...</p>
                </div>

                <!-- 關西機場 -->
                <div id="weather-kix"
                    class="bg-white p-3 rounded-lg shadow-sm text-center weather-loading min-h-[120px] flex flex-col justify-center">
                    <p class="text-sm font-bold text-gray-700 mb-1">關西機場 (KIX)</p>
                    <p class="text-xs text-gray-400">載入中...</p>
                </div>
            </div>
            <p class="text-xs text-gray-400 mt-2 text-right">*顯示今日即時預報</p>
        </div>

        <!-- 區塊二：飯店 → 關西機場：分步導航 -->
        <div class="route-card bg-gray-100 border-t-4 border-red-500">
            <h3 class="text-2xl font-semibold text-gray-800 mb-5 flex items-center border-b pb-3">
                <span class="mr-2">🚂</span> 飯店 → 關西機場：分步導航 (Haruka)
            </h3>

            <!-- 步驟容器 -->
            <div class="space-y-6">
                <!-- 步驟 1: Hotel -> Kyoto Station Walk -->
                <div class="border-l-4 border-yellow-500 pl-4">
                    <h4 class="text-lg font-bold text-gray-900 flex items-center mb-1">
                        <span
                            class="bg-yellow-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2">1</span>
                        🚶 步行至京都車站
                    </h4>
                    <p class="text-sm text-gray-600 ml-8">
                        <span class="font-bold text-blue-700">區間：</span> <strong>飯店</strong> → <strong>JR 京都車站</strong>
                        (Kyoto Station)<br>
                        <span class="font-bold text-blue-700">時長：</span> 約 <strong>7-10 分鐘</strong><br>
                        <span class="font-bold text-blue-700">指示：</span> 從<strong>八條口</strong> (南側) 進入車站，找尋 JR
                        <strong>特急 Haruka</strong> 的月台。
                    </p>
                </div>

                <!-- 步驟 2: Kyoto -> KIX Haruka Limited Express -->
                <div class="border-l-4 border-green-500 pl-4">
                    <h4 class="text-lg font-bold text-gray-900 flex items-center mb-1">
                        <span
                            class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2">2</span>
                        ✈️ 京都車站 → 關西機場 (KIX)
                    </h4>
                    <p class="text-sm text-gray-600 ml-8">
                        <span class="font-bold text-blue-700">區間：</span> <strong>京都站</strong> → <strong>關西國際機場</strong>
                        (KIX)<br>
                        <span class="font-bold text-blue-700">交通：</span> JR 特急列車<br>
                        <span class="font-bold text-blue-700">車種/路線：</span> <strong>關空特快 Haruka 9</strong> (はるか)<strong
                            class="text-red-600 font-extrabold">(最晚一定要搭上)</strong><br>
                        <span class="font-bold text-blue-700">乘車時間：</span> <strong
                            class="text-red-600 font-extrabold">07：48</strong><br>
                        <span class="font-bold text-blue-700">抵達時間：</span> <strong
                            class="text-red-600 font-extrabold">09：13</strong><br>
                        <span class="font-bold text-blue-700">時長：</span> 約 <strong>1 小時 25 分鐘</strong><br>
                        <span class="font-bold text-blue-700">費用：</span> <span class="text-red-600 font-extrabold">使用JR
                            PASS(指定席需要先預訂)</span> <br>
                    </p>
                </div>

                <!-- 步驟 3: KIX Check-in -->
                <div class="border-l-4 border-pink-500 pl-4">
                    <h4 class="text-lg font-bold text-gray-900 flex items-center mb-1">
                        <span
                            class="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2">3</span>
                        🛫 抵達機場與 Check-in
                    </h4>
                    <p class="text-sm text-gray-600 ml-8">
                        <span class="font-bold text-blue-700">指示：</span> 抵達 <strong
                            class="text-red-600 font-extrabold">關西機場</strong>後，依循指示牌前往<strong
                            class="text-red-600 font-extrabold">第一航廈 (T1) </strong>辦理長榮航空 (BR) 的登機手續。<br>
                        <span class="font-bold text-blue-700">預計抵達：</span> 約 <strong>09:20</strong><br>
                        <span class="font-bold text-blue-700">備註：</span> 國際線建議提前 2 小時報到。
                    </p>
                </div>
            </div>
        </div>

        <!-- 區塊三：最終確認清單 (Checklist) - 已更新為返程專用 -->
        <div class="route-card bg-green-50 border-t-4 border-green-500">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-semibold text-green-800 flex items-center">
                    <span class="mr-2">✅</span> 返程行李檢查清單
                </h3>
                <button onclick="resetChecklist()" class="text-xs text-red-500 underline">重置清單</button>
            </div>
            <p class="text-sm text-gray-600 mb-4">最後退房前請務必逐一確認。</p>

            <div class="space-y-4">
                <!-- 1. 託運與安檢規定 (最重要！) -->
                <div>
                    <h4 class="font-bold text-red-600 mb-2">⛔ 安檢與託運規定 (請務必確認)</h4>
                    <div class="bg-white rounded-lg shadow p-3 space-y-2 border-l-4 border-red-500">
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500"
                                data-id="check_batteries">
                            <span class="text-gray-900 font-bold">行動電源/鋰電池 (務必放在隨身包，不可託運)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500"
                                data-id="check_liquids">
                            <span class="text-gray-900 font-bold">液體 > 100ml (布丁/果凍/酒水 務必放入託運)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500"
                                data-id="check_liquids">
                            <span class="text-gray-900 font-bold">平板電腦、相機電池(不可託運，要隨身攜帶)</span>
                        </label>
						<label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="check_weight">
                            <span class="text-gray-800">行李秤重 (確認未超重，長榮計件制每件23kg)</span>
                        </label>
                    </div>
                </div>

                <!-- 2. 飯店房間最後巡視 -->
                <div>
                    <h4 class="font-bold text-green-700 mb-2">🏨 飯店房間最後巡視 (Don't forget!)</h4>
                    <div class="bg-white rounded-lg shadow p-3 space-y-2">
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="sweep_safe">
                            <span class="text-gray-800">保險箱 (護照/錢包是否已取出？)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="sweep_outlets">
                            <span class="text-gray-800">插座巡視 (充電頭/充電線/轉接頭)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="sweep_bathroom">
                            <span class="text-gray-800">浴室 (洗面乳/電動刮鬍刀/牙刷)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="sweep_fridge">
                            <span class="text-gray-800">冰箱 (是否還有昨晚買的水果/甜點？)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="sweep_bed">
                            <span class="text-gray-800">棉被/床底 (掀開檢查是否有手機/衣物遺落)</span>
                        </label>
                    </div>
                </div>

                <!-- 3. 隨身證件與電子產品 -->
                <div>
                    <h4 class="font-bold text-green-700 mb-2">🎒 隨身包包 (Check-in 必備)</h4>
                    <div class="bg-white rounded-lg shadow p-3 space-y-2">
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="return_passport">
                            <span class="text-gray-800">護照 (所有人護照都在負責人身上嗎？)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="return_wallet">
                            <span class="text-gray-800">錢包/日幣 (留一點零錢機場投販賣機)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="return_phone">
                            <span class="text-gray-800">手機 & 網卡 (SIM卡針帶著，回台換卡用)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="return_keys">
                            <span class="text-gray-800">台灣家裡鑰匙/車鑰匙 (別鎖在託運行李裡！)</span>
                        </label>
                    </div>
                </div>

                <!-- 4. 戰利品與衣物 -->
                <div>
                    <h4 class="font-bold text-green-700 mb-2">🎁 戰利品與衣物整理</h4>
                    <div class="bg-white rounded-lg shadow p-3 space-y-2">
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="pack_cookies">
                            <span class="text-gray-800">餅乾/易碎伴手禮 (建議用衣物包裹防撞)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="pack_dirty">
                            <span class="text-gray-800">髒衣物 (集中打包，與乾淨衣物分開)</span>
                        </label>
                        <label class="checklist-item flex items-center space-x-3 cursor-pointer">
                            <input type="checkbox"
                                class="form-checkbox h-5 w-5 text-green-600 rounded focus:ring-green-500"
                                data-id="wear_comfy">
                            <span class="text-gray-800">今日穿搭 (洋蔥式穿法，適應機上與台灣溫差)</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script to fetch Weather Data via Open-Meteo (Uses JMA models) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Weather logic is called inside standard initialization
            fetchWeather();

            // Checklist Logic
            const checkboxes = document.querySelectorAll('input[type="checkbox"][data-id]');

            // Load saved state
            checkboxes.forEach(box => {
                const id = box.getAttribute('data-id');
                const saved = localStorage.getItem('checklist_' + id);
                if (saved === 'true') {
                    box.checked = true;
                }

                // Add change listener
                box.addEventListener('change', (e) => {
                    localStorage.setItem('checklist_' + id, e.target.checked);
                });
            });
        });

        function resetChecklist() {
            if (confirm('確定要重置所有勾選項目嗎？')) {
                const checkboxes = document.querySelectorAll('input[type="checkbox"][data-id]');
                checkboxes.forEach(box => {
                    box.checked = false;
                    const id = box.getAttribute('data-id');
                    localStorage.removeItem('checklist_' + id);
                });
            }
        }

        async function fetchWeather() {
            // 定義地點與座標 (京都車站, 關西機場)
            const locations = [
                { id: 'weather-kyoto', name: '京都車站', lat: 34.9858, lon: 135.7588 },
                { id: 'weather-kix', name: '關西機場', lat: 34.4347, lon: 135.2323 }
            ];

            // 構建批量請求 URL
            const lats = locations.map(l => l.lat).join(',');
            const lons = locations.map(l => l.lon).join(',');
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lats}&longitude=${lons}&daily=weather_code,temperature_2m_max,precipitation_probability_max&timezone=Asia%2FTokyo&forecast_days=1`;

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();

                // Open-Meteo 對於單一地點回傳物件，多地點回傳陣列
                const results = Array.isArray(data) ? data : [data];

                results.forEach((result, index) => {
                    const loc = locations[index];
                    const daily = result.daily;
                    const code = daily.weather_code[0];
                    const maxTemp = Math.round(daily.temperature_2m_max[0]);
                    const rainProb = daily.precipitation_probability_max[0];

                    const weatherInfo = getWeatherInfo(code);

                    const container = document.getElementById(loc.id);
                    container.innerHTML = `
                        <div class="flex flex-col items-center h-full justify-between py-1">
                            <div class="text-center">
                                <p class="text-base font-bold text-gray-800">${loc.name}</p>
                                <div class="text-3xl my-1">${weatherInfo.icon}</div>
                                <p class="text-xs text-gray-500 font-medium">${weatherInfo.text}</p>
                            </div>
                            <div class="flex space-x-2 mt-2 text-xs w-full justify-center bg-gray-50 rounded py-1">
                                <div class="flex flex-col items-center">
                                    <span class="text-blue-500 font-bold">☔ ${rainProb}%</span>
                                </div>
                                <div class="border-l border-gray-300"></div>
                                <div class="flex flex-col items-center">
                                    <span class="text-red-500 font-bold">🌡️ ${maxTemp}°C</span>
                                </div>
                            </div>
                        </div>
                    `;
                    container.classList.remove('weather-loading');
                });

            } catch (error) {
                console.error('Weather fetch error:', error);
                locations.forEach(loc => {
                    const el = document.getElementById(loc.id);
                    if (el) {
                        el.innerHTML = `<p class="text-xs text-red-400">暫時無法取得</p>`;
                        el.classList.remove('weather-loading');
                    }
                });
            }
        }

        // WMO Weather Code Mapping to Traditional Chinese & Icons
        function getWeatherInfo(code) {
            // WMO Weather interpretation codes (WW)
            if (code === 0) return { text: '晴朗', icon: '☀️' };
            if (code >= 1 && code <= 3) return { text: '多雲時晴', icon: '⛅' };
            if (code === 45 || code === 48) return { text: '有霧', icon: '🌫️' };
            if (code >= 51 && code <= 55) return { text: '毛毛雨', icon: '🌧️' };
            if (code >= 56 && code <= 57) return { text: '凍雨', icon: '🌨️' };
            if (code >= 61 && code <= 65) return { text: '下雨', icon: '☔' };
            if (code >= 66 && code <= 67) return { text: '凍雨', icon: '🌨️' };
            if (code >= 71 && code <= 77) return { text: '降雪', icon: '❄️' };
            if (code >= 80 && code <= 82) return { text: '陣雨', icon: '🌦️' };
            if (code >= 85 && code <= 86) return { text: '陣雪', icon: '🌨️' };
            if (code >= 95 && code <= 99) return { text: '雷雨', icon: '⛈️' };
            return { text: '未知', icon: '❓' };
        }
    </script>
</body>

</html>